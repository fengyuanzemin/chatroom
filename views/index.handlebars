<style>
html{
padding-bottom: 46px;
}
form { 
    background: #000; 
    padding: .3rem; 
    position: fixed; 
    bottom: 0; 
    left: 0;
    width: 100%; 
}
form input { 
    border: 0; 
    padding: 10px; 
    width: 90%; 
    margin-right: .3rem; 
}
form button { 
    width: 9%; 
    background: rgb(130, 224, 255); 
    border: none; 
    padding: .625rem; 
}
#messages { 
    list-style-type: none; 
    margin: 0; 
    padding: 0; 
}
#messages li { 
    padding: .3125rem .625rem; 
}
#messages li:nth-child(odd) .chat{ 
    background-color: #eee; 
}
#messages li:nth-child(even) .chat{
	background-color: #d4edf4;
}
#messages li:nth-child(odd) .tan{
	 border-right-color: #eee;
}
#messages li:nth-child(even) .tan{
	 border-right-color: #d4edf4;
}
.name{
    font-size: 1.1rem;
    text-align: center;
}
li img{
	max-width: 100%;
}
li .avatar{
	display: inline-block;
	width: 4.44rem;
	height: 7.19rem;
}
li .chat{
	width: 18rem;
	display: inline-block;
	height: 3rem;
	position:relative;
	bottom: 3.6rem;
	left: 3rem;
	border-radius: .4rem;
	text-indent: .5rem;
	padding-top: .25rem;
}
.tan{
	display: inline-block;
	position: absolute;
	top: .6rem;
	left: -1.7rem;
	border-top: .7rem solid transparent;
	border-right: 1.8rem solid #fff;
	border-bottom: .2rem solid transparent;
}
</style>


<ul id="messages">
	{{!-- <li>
		<div class="avatar">
			<img src="imgs/1.jpg" alt="头像" />
			<p class="name">李晖梁<p>
		</div>
		<div class="chat">
			<span class="tan"></span>
			<p>我来了</p>
		</div>
	</li> --}}
</ul>
<form>
     <input id="m" autocomplete="off" /><button>发送</button>
</form>
<script src="//cdn.bootcss.com/socket.io/1.4.6/socket.io.min.js"></script>
	
<script>
    $(function(){
        var name = prompt("输入昵称");
        if($.trim(name).length > 0) {
            $('#m').focus();
            // 聊天开始
            var socket = io();
            // 
            socket.emit('user connection', name);
            $('button').click(function(){
                socket.emit('chat message', $('#m').val());
                $('#m').val('');
                return false;
            });
            socket.on('chat message', function(msg){
                $('#messages').append(
                	'<li>'+
					'<div class="avatar">'+
					'<img src="imgs/1.jpg" alt="头像" />'+
					'<p class="name">'+msg.user.name+'<p>'+
					'</div>'+
					'<div class="chat">'+
					'<span class="tan"></span>'+
					'<p>'+msg.msg+'</p>'+
					'</div>'+
					'</li>');
            	$('html, body, #message').animate({scrollTop: $(document).height()}, 400);
          	});
            socket.on('hi', function(msg){
                $('#messages').append($('<li style="text-align: center;">').text(msg));
                $('html, body, #message').animate({scrollTop: $(document).height()}, 400);
            });
        }
    });
</script>